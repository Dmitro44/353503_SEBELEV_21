{% extends 'base.html' %}

{% block title %}О компании - Автопрокат{% endblock %}

{% block content %}
<div class="content-container">
    <h1>О компании</h1>

    <div class="about-layout">
        <!-- Left Column: Navigation -->
        <aside class="about-nav-column">
            <div class="nav-container">
                <div class="nav-section">
                    <h5>Навигация</h5>
                    <ul>
                        <li><a href="#video-advantages">Видео и преимущества</a></li>
                        {% if company_info.history %}<li><a href="#history">История</a></li>{% endif %}
                        <li><a href="#details">Детали</a></li>
                    </ul>
                     {% if user.is_authenticated and is_staff_user or is_admin_user %}
                        <div class="staff-link">
                            <a href="{% url 'statistics_dashboard' %}" class="btn btn-secondary">Статистика</a>
                        </div>
                    {% endif %}
                </div>
            </div>
        </aside>

        <!-- Right Column: Main Content -->
        <main class="about-content-column">
            {% if company_info %}
                <section class="company-description">
                    <h2>{{ company_info.name }}</h2>
                    <div>{{ company_info.description|linebreaks }}</div>
                </section>

                <div id="video-advantages" class="content-row">
                    {% if company_info.video_url %}
                    <section class="video-section">
                        <h3>Видео о компании</h3>
                        <video autoplay muted loop controls>
                            <source src="{{ company_info.video_url }}" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </section>
                    {% endif %}

                    <section id="advantages" class="advantages-section">
                        <h3>Наши преимущества</h3>
                        <div class="advantages-list">
                            <article>
                                <h4>Большой выбор автомобилей</h4>
                                <p>У нас вы найдете автомобили различных классов и марок. <q>Лучший выбор в городе!</q> - говорит один из наших клиентов.</p>
                            </article>
                            <article>
                                <h4>Доступные цены</h4>
                                <p>Мы предлагаем конкурентные цены и гибкую систему скидок для всех клиентов в <abbr title="Республика Беларусь">РБ</abbr>.</p>
                            </article>
                            <article class="last-advantage">
                                <h4>Поддержка 24/7</h4>
                                <p>Наша служба поддержки всегда готова помочь вам.</p>
                            </article>
                        </div>
                    </section>
                </div>

                {% if company_info.history %}
                <section id="history" class="history-section">
                    <h3>История компании</h3>
                    <div>{{ company_info.history|linebreaks }}</div>
                </section>
                {% endif %}

                <div id="details" class="content-row">
                    {% if company_info.certificate_details.all %}
                    <section class="certificate-section">
                        <div class="certificate">
                            <div class="certificate-border">
                                <div class="certificate-content">
                                    <div class="certificate-header">Сертификат соответствия</div>
                                    <div class="certificate-body">
                                        <div class="certificate-details">
                                            {% with details=company_info.certificate_details.all %}
                                                {% if details %}
                                                    <p>{{ details.0.text }}</p>
                                                    <h4>"{{ company_info.name }}"</h4>
                                                    {% for detail in details|slice:"1:" %}
                                                        {% if detail.detail_type == 'inn' %}
                                                            <p class="certificate-detail-{{ detail.detail_type }}">{{ detail.text }}</p>
                                                        {% elif detail.detail_type == 'reg' %}
                                                            <p class="certificate-detail-{{ detail.detail_type }}">{{ detail.text }}</p>
                                                        {% else %}
                                                            <p>{{ detail.text }}</p>
                                                        {% endif %}
                                                    {% endfor %}
                                                {% endif %}
                                            {% endwith %}
                                        </div>
                                    </div>
                                    <div class="certificate-footer">
                                        <div class="seal"></div>
                                        <p>Дата выдачи: {{ company_info.certificate_issue_date|date:"d F Y" }}</p>
                                        {% if company_info.certificate_expiry_date %}
                                            <p>Действителен до: {{ company_info.certificate_expiry_date|date:"d F Y" }}</p>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    {% endif %}

                    <div class="details-column">
                        {% if company_info.requisites %}
                        <section class="requisites-section">
                            <h3>Реквизиты</h3>
                            <div>{{ company_info.requisites|linebreaks }}</div>
                        </section>
                        {% endif %}

                        <section id="anthem" class="anthem-section">
                            <h3>Гимн компании</h3>
                            <pre>
По дорогам мчим мы смело,
Солнце светит ярко нам.
"Автопрокат" - благое дело,
Рады мы всегда гостям!
                            </pre>
                            <audio controls>
                                <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
                                Your browser does not support the audio element.
                            </audio>
                        </section>
                    </div>
                </div>
            {% else %}
                <p>Информация о компании не найдена.</p>
            {% endif %}
        </main>
    </div>
</div>
{% endblock %}