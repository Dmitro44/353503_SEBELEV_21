{% extends 'base.html' %}

{% block title %}Корзина{% endblock %}

{% block content %}
<div class="content-container">
    <div class="page-header">
        <h1>Ваша корзина</h1>
    </div>

    {% if cart_items %}
        <div class="table-container">
            <table class="table">
                <thead>
                    <tr>
                        <th>Автомобиль</th>
                        <th>Дни аренды</th>
                        <th>Промокод</th>
                        <th>Цена за день</th>
                        <th>Всего</th>
                        <th class="action-cell">Действия</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in cart_items %}
                        <tr>
                            <td>{{ item.vehicle.car_model }}</td>
                            <td>
                                <form action="{% url 'update_cart_item' item.pk %}" method="post" class="form-inline">
                                    {% csrf_token %}
                                    <input type="number" name="rental_days" value="{{ item.rental_days }}" min="1" class="form-control" style="width: 80px; margin-right: 10px;">
                                    <button type="submit" class="btn btn-secondary btn-sm">Обновить</button>
                                </form>
                            </td>
                            <td>{% if item.promo_code %}{{ item.promo_code.code }}{% else %}-{% endif %}</td>
                            <td>{{ item.vehicle.daily_rental_price }} $</td>
                            <td>{{ item.total_price }} $</td>
                            <td class="action-cell">
                                <form action="{% url 'remove_from_cart' item.pk %}" method="post">
                                    {% csrf_token %}
                                    <button type="submit" class="btn btn-danger btn-sm">Удалить</button>
                                </form>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="cart-summary">
            <h3>Итого: {{ total_cart_price }} $</h3>
        </div>

        <div class="cart-actions">
            <a href="{% url 'payment' %}" class="btn btn-primary">Оплатить</a>
        </div>

    {% else %}
        <div class="alert alert-info">
            <p>Ваша корзина пуста.</p>
        </div>
    {% endif %}
</div>
{% endblock %}