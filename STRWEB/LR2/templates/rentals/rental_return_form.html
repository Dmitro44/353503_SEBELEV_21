{% extends 'base.html' %}

{% block title %}Возврат автомобиля - Автопрокат{% endblock %}

{% block content %}
<div class="content-container">
    <div class="rental-return-container">
        <div class="rental-return-header">
            <h3>Возврат автомобиля</h3>
        </div>
        <div class="rental-return-body">
            <div class="rental-return-info">
                <!--TODO: Вынести стили для vehicle image в отдельный файл? -->
                <div class="vehicle-image-container">
                    {% if rental.vehicle.image %}
                        <img src="{{ rental.vehicle.image.url }}" alt="{{ rental.vehicle }}" class="vehicle-image">
                    {% endif %}
                </div>
                <h5>Информация об аренде</h5>
                <p><strong>Автомобиль:</strong> {{ rental.vehicle }}</p>
                <p><strong>Клиент:</strong> {{ rental.user.get_full_name|default:rental.user.username }}</p>
                <p><strong>Дата начала:</strong> {{ rental.rental_date|date:"d.m.Y" }}</p>
                <p><strong>Ожидаемая дата возврата:</strong> {{ rental.expected_return_date|date:"d.m.Y" }}</p>
                <p><strong>Сумма аренды:</strong> $ {{ rental.rental_amount }}</p>
            </div>
            
            <form method="post" novalidate class="rental-return-form">
                {% csrf_token %}
                
                <div class="form-group">
                    <label class="form-label" for="{{ form.actual_return_date.id_for_label }}">{{ form.actual_return_date.label|default:"Фактическая дата возврата" }}</label>
                    {{ form.actual_return_date }}
                    {% if form.actual_return_date.help_text %}
                        <small class="form-text text-muted">{{ form.actual_return_date.help_text }}</small>
                    {% endif %}
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="{{ form.condition_notes.id_for_label }}">{{ form.condition_notes.label|default:"Примечания о состоянии автомобиля" }}</label>
                    {{ form.condition_notes }}
                    {% if form.condition_notes.help_text %}
                        <small class="form-text text-muted">{{ form.condition_notes.help_text }}</small>
                    {% endif %}
                </div>
                
                <div class="form-group">
                    <div class="form-group">
                        <label class="form-label">{{ form.penalty_types.label|default:"Типы штрафов" }}</label>
                        <p>Выберите штрафы, если автомобиль возвращен в ненадлежащем состоянии:</p>
                        <div class="penalty-types-list">
                            {{ form.penalty_types }}
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="{{ form.penalty_notes.id_for_label }}">{{ form.penalty_notes.label|default:"Примечания к штрафам" }}</label>
                        {{ form.penalty_notes }}
                    </div>
                </div>
                
                <div class="rental-return-footer">
                    <a href="{% url 'rental_detail' rental.pk %}" class="btn btn-secondary">Назад к деталям аренды</a>
                    <button type="submit" class="btn btn-primary">Оформить возврат</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
