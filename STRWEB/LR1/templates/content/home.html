{% extends 'base.html' %}

{% block title %}Главная - Автопрокат{% endblock %}

{% block content %}
<div>
    {% if banners %}
    <section>
        <h1>Рекламные баннеры</h1>
        <div style="display: flex; flex-wrap: wrap; gap: 20px;">
            {% for banner in banners %}
            <div style="max-width: 400px; text-align: center;">
                <a href="{{ banner.link }}" style="text-decoration: none; color: inherit;">
                    <img src="{{ banner.image.url }}" alt="{{ banner.title }}" style="width: 100%; height: auto; border-radius: 8px;">
                </a>
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    {% if vehicles %}
    <section>
        <h2>Новые поступления</h2>
        {% for vehicle in vehicles %}
        <article>
            {% if vehicle.image %}
            <img src="{{ vehicle.image.url }}" alt="{{ vehicle.car_model }}" style="width:300px;">
            {% else %}
            <img src="https://via.placeholder.com/300x200/CCCCCC/FFFFFF?text=No+Image" alt="No Image" style="width:300px;">
            {% endif %}
            <h3>{{ vehicle.car_model }}</h3>
            <p>Год: {{ vehicle.year }}</p>
            <p>Цена: {{ vehicle.daily_rental_price }} руб./сутки</p>
            <a href="{% url 'vehicle_detail' vehicle.pk %}">Подробнее</a>
        </article>
        {% endfor %}
    </section>
    {% endif %}

    <section>
        <article>
            <h3>Автомобили</h3>
            <p>Просмотр доступных автомобилей для аренды.</p>
            <a href="{% url 'vehicle_list' %}">Перейти</a>
        </article>
        <article>
            <h3>О компании</h3>
            <p>Информация о нашей компании и услугах.</p>
            <a href="{% url 'about' %}">Подробнее</a>
        </article>
        <article>
            <h3>Новости</h3>
            <p>Последние новости и акции компании.</p>
            <a href="{% url 'news_list' %}">Читать</a>
        </article>
    </section>

    {% if latest_article %}
        <section>
            <h3>Последняя новость</h3>
            <article>
                {% if latest_article.image %}
                    <img src="{{ latest_article.image.url }}" alt="{{ latest_article.title }}" style="width:400px;">
                {% endif %}
                <h4>{{ latest_article.title }}</h4>
                <p><small>Опубликовано: {{ latest_article.published_at|date:"d.m.Y" }}</small></p>
                <p>{{ latest_article.summary }}</p>
                <a href="{% url 'news_detail' latest_article.pk %}">Читать полностью</a>
            </article>
        </section>
    {% endif %}

    {% if partners %}
    <section>
        <h2>Наши партнеры</h2>
        {% for partner in partners %}
        <div>
            <a href="{{ partner.website_url }}" target="_blank" rel="noopener noreferrer">
                {% if partner.logo %}
                <img src="{{ partner.logo.url }}" alt="{{ partner.name }}" style="max-height: 80px;">
                {% else %}
                <span>{{ partner.name }}</span>
                {% endif %}
            </a>
        </div>
        {% endfor %}
    </section>
    {% endif %}

    <section>
        <article>
            <h3>Отзывы</h3>
            <p>Отзывы наших клиентов о сервисе.</p>
            <a href="{% url 'review_list' %}">Смотреть отзывы</a>
        </article>
        <article>
            <h3>Промокоды</h3>
            <p>Действующие промокоды и скидки.</p>
            <a href="{% url 'promocode_list' %}">Посмотреть</a>
        </article>
    </section>

    <section>
        <h3>Календарь</h3>
        {{ calendar|safe }}
    </section>

    <section>
        <h3>Случайная шутка</h3>
        <div>
            {% if joke_setup %}
                <p>{{ joke_setup }}</p>
                <p><strong>{{ joke_punchline }}</strong></p>
            {% else %}
                <p>Нажмите на кнопку, чтобы получить шутку</p>
            {% endif %}
        </div>
        <form method="GET">
            <input type="hidden" name="get_joke" value="1">
            <button type="submit">Получить случайную шутку</button>
        </form>
    </section>

    <section>
        <h3>Интересный факт о кошках</h3>
        <p>{{ cat_fact }}</p>
        <form method="GET">
            <input type="hidden" name="refresh_cat_fact" value="1">
            <button type="submit">Обновить факт</button>
        </form>
    </section>
</div>
{% endblock %}